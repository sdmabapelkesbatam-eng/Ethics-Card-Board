// Ganti dengan URL CSV yang Anda dapatkan dari Langkah 1.1 dan 1.2
const URL_NILAI = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSHdNDTOGnBgZXRUkqcCT8GwOYO5HgzPpRNMEtwpjQeox8fRcHdo6VSzYof_UOgg0s_YszpsHZW-zs0/pub?gid=0&single=true&output=csv';
const URL_PEGAWAI = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSHdNDTOGnBgZXRUkqcCT8GwOYO5HgzPpRNMEtwpjQeox8fRcHdo6VSzYof_UOgg0s_YszpsHZW-zs0/pub?gid=771208512&single=true&output=csv
';
// Ganti dengan URL Aplikasi Web yang Anda dapatkan dari Langkah 1.3
const URL_RATING = 'https://script.google.com/macros/s/AKfycbw4WsoC_gAGMLE4HhLYiuwBdLK2AvRZBpW-iH3HLqX15m8t_I9PMa8HRXq3CdyQa8wB/exec';

let currentCardIndex = 0;
let nilaiData = [];
let pegawaiData = [];

const cardContainer = document.getElementById('card-container');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const ratingSection = document.getElementById('rating-section');
const ratingForm = document.getElementById('rating-form');
const submitBtn = document.getElementById('submit-rating-btn');

function parseCSV(csvText) {
    const lines = csvText.trim().split('\n');
    const headers = lines[0].split(',').map(header => header.trim());
    return lines.slice(1).map(line => {
        const data = line.split(',');
        const obj = {};
        headers.forEach((header, i) => {
            obj[header] = data[i].trim();
        });
        return obj;
    });
}

async function fetchData() {
    try {
        const responseNilai = await fetch(URL_NILAI);
        const csvNilai = await responseNilai.text();
        nilaiData = parseCSV(csvNilai);

        const responsePegawai = await fetch(URL_PEGAWAI);
        const csvPegawai = await responsePegawai.text();
        pegawaiData = parseCSV(csvPegawai);

        renderCards();
    } catch (error) {
        console.error("Gagal mengambil data:", error);
        cardContainer.innerHTML = "<p>Gagal memuat konten. Silakan periksa kembali URL Google Sheets Anda.</p>";
    }
}

function renderCards() {
    cardContainer.innerHTML = '';
    nilaiData.forEach((nilai, index) => {
        const card = document.createElement('div');
        card.className = 'ethics-card';
        card.id = `card-${index}`;
        if (index === currentCardIndex) {
            card.classList.add('active');
        }
